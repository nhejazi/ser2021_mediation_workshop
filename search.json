[{"path":"index.html","id":"welcome-to-ser","chapter":"Welcome to SER!","heading":"Welcome to SER!","text":"open source, reproducible vignette accompanies half-day workshop \nmodern methods causal mediation analysis, given SER 2021\nMeeting Monday, 24 May 2021. encourage use bookdown\nsite, convenience, also made workshop materials available \nPDF.","code":""},{"path":"index.html","id":"about","chapter":"Welcome to SER!","heading":"0.1 About this workshop","text":"Causal mediation analysis can provide mechanistic understanding \nexposure impacts outcome, central goal epidemiology health sciences.\nHowever, rapid methodologic developments coupled formal courses\npresents challenges implementation. Beginning overview classical\ndirect indirect effects, workshop present recent advances \novercome limitations previous methods, allowing : () continuous\nexposures, (ii) multiple, non-independent mediators, (iii) effects\nidentifiable presence intermediate confounders affected exposure.\nEmphasis placed flexible, stochastic interventional direct \nindirect effects, highlighting may applied answer substantive\nepidemiological questions real-world studies. Multiply robust,\nnonparametric estimators causal effects, free open source R\npackages (medshift \nmedoutcon) application, \nintroduced.ensure translation real-world data analysis, workshop \nincorporate hands-R programming exercises allow participants practice \nimplementing statistical tools presented. recommended \nparticipants working knowledge basic notions causal inference,\nincluding counterfactuals identification (linking causal effect \nparameter estimable observed data distribution). Familiarity \nR programming language also recommended.","code":""},{"path":"index.html","id":"schedule","chapter":"Welcome to SER!","heading":"0.2 Workshop schedule","text":"10:00A-10:30A: introductions/mediation set up10:30A-11:00A: estimands choose11:00A-11:30A: discussion: choose real-world examples11:30A-12:00P: shift parameter introduction application lecture part12:00P-12:15P break/discussion12:15P-12:45P estimation natural direct indirect effects,\ninterventional direct indirect effects12:45P-01:15P: practice R code estimation01:15P-01:30P: estimation stochastic interventional direct indirect\neffects01:30P-01:50P: practice: code estimation01:50P-02:00P wrap upNOTE: times listed Pacific Time.","code":""},{"path":"index.html","id":"instructors","chapter":"Welcome to SER!","heading":"0.3 About the instructors","text":"","code":""},{"path":"index.html","id":"iván-díaz","chapter":"Welcome to SER!","heading":"Iván Díaz","text":"research focuses development non-parametric statistical methods \ncausal inference observational randomized studies complex\ndatasets, using machine learning. includes limited mediation\nanalysis, methods continuous exposures, longitudinal data including survival\nanalysis, efficiency guarantees covariate adjustment randomized\ntrials. also interested general semi-parametric theory, machine\nlearning, high-dimensional data.","code":""},{"path":"index.html","id":"nima-hejazi","chapter":"Welcome to SER!","heading":"Nima Hejazi","text":"PhD candidate biostatistics UC Berkeley, working joint\ndirection Mark van der Laan Alan Hubbard. research interests fall \nintersection causal inference machine learning, drawing ideas \nnon/semi-parametric estimation large, flexible statistical models develop\nefficient robust statistical procedures evaluating complex target\nestimands observational randomized studies. Particular areas current\nemphasis include causal mediation/path analysis, outcome-dependent sampling\ndesigns, targeted loss-based estimation, applications vaccine efficacy\ntrials. also passionate statistical computing open source\nsoftware development applied statistics.","code":""},{"path":"index.html","id":"kara-rudolph","chapter":"Welcome to SER!","heading":"Kara Rudolph","text":"Assistant Professor Epidemiology Columbia University. research\ninterests developing applying causal inference methods understand\nsocial contextual influences mental health, substance use, violence\ndisadvantaged, urban areas United States. current work focuses \ndeveloping methods transportability mediation, subsequently applying\nmethods understand aspects school peer environments\nmediate relationships neighborhood factors adolescent drug use\nacross populations. generally, work generalizing/ transporting\nfindings study samples target populations identifying subpopulations\nlikely benefit interventions contributes efforts optimally\ntarget available policy program resources.","code":""},{"path":"index.html","id":"repro","chapter":"Welcome to SER!","heading":"0.4 Reproduciblity","text":"workshop materials written using bookdown,\ncomplete source available \nGitHub. version book\nbuilt R version 4.0.5 (2021-03-31), pandoc version r rmarkdown::pandoc_version(), following packages:","code":""},{"path":"index.html","id":"setup","chapter":"Welcome to SER!","heading":"0.5 Setup instructions","text":"","code":""},{"path":"index.html","id":"r-and-rstudio","chapter":"Welcome to SER!","heading":"0.5.1 R and RStudio","text":"R RStudio separate downloads installations. R \nunderlying statistical computing environment. RStudio graphical integrated\ndevelopment environment (IDE) makes using R much easier \ninteractive. need install R install RStudio.","code":""},{"path":"index.html","id":"windows","chapter":"Welcome to SER!","heading":"0.5.1.1 Windows","text":"","code":""},{"path":"index.html","id":"if-you-already-have-r-and-rstudio-installed","chapter":"Welcome to SER!","heading":"0.5.1.1.1 If you already have R and RStudio installed","text":"Open RStudio, click “Help” > “Check updates”. new version \navailable, quit RStudio, download latest version RStudio.check version R using, start RStudio first thing\nappears console indicates version R \nrunning. Alternatively, can type sessionInfo(), also display\nversion R running. Go CRAN\nwebsite check whether \nrecent version available. , please download install . \ncan check \ninformation remove old versions system \nwish .","code":""},{"path":"index.html","id":"if-you-dont-have-r-and-rstudio-installed","chapter":"Welcome to SER!","heading":"0.5.1.1.2 If you don’t have R and RStudio installed","text":"Download R \nCRAN website.Run .exe file just downloadedGo RStudio download\npageUnder Installers select RStudio x.yy.zzz - Windows\nXP/Vista/7/8 (x, y, z represent version numbers)Double click file install itOnce ’s installed, open RStudio make sure works don’t get \nerror messages.","code":""},{"path":"index.html","id":"macos-mac-os-x","chapter":"Welcome to SER!","heading":"0.5.1.2 macOS / Mac OS X","text":"","code":""},{"path":"index.html","id":"if-you-already-have-r-and-rstudio-installed-1","chapter":"Welcome to SER!","heading":"0.5.1.2.1 If you already have R and RStudio installed","text":"Open RStudio, click “Help” > “Check updates”. new version \navailable, quit RStudio, download latest version RStudio.check version R using, start RStudio first thing\nappears terminal indicates version R running.\nAlternatively, can type sessionInfo(), also display \nversion R running. Go CRAN\nwebsite check whether \nrecent version available. , please download install .","code":""},{"path":"index.html","id":"if-you-dont-have-r-and-rstudio-installed-1","chapter":"Welcome to SER!","heading":"0.5.1.2.2 If you don’t have R and RStudio installed","text":"Download R \nCRAN website.Select .pkg file latest R versionDouble click downloaded file install RIt also good idea install XQuartz (needed\npackages)Go RStudio download\npageUnder Installers select RStudio x.yy.zzz - Mac OS X 10.6+ (64-bit)\n(x, y, z represent version numbers)Double click file install RStudioOnce ’s installed, open RStudio make sure works don’t get \nerror messages.","code":""},{"path":"index.html","id":"linux","chapter":"Welcome to SER!","heading":"0.5.1.3 Linux","text":"Follow instructions distribution\nCRAN, provide information\nget recent version R common distributions. \ndistributions, use package manager (e.g., Debian/Ubuntu run\nsudo apt-get install r-base, Fedora sudo yum install R), \ndon’t recommend approach versions provided \nusually date. case, make sure least R 3.3.1.Go RStudio download\npageUnder Installers select version matches distribution, \ninstall preferred method (e.g., Debian/Ubuntu sudo dpkg -rstudio-x.yy.zzz-amd64.deb terminal).’s installed, open RStudio make sure works don’t get \nerror messages.setup instructions adapted written Data Carpentry: R\nData Analysis Visualization Ecological\nData.","code":""},{"path":"mediation.html","id":"mediation","chapter":"1 Causal Mediation Analysis","heading":"1 Causal Mediation Analysis","text":"[FILL ]","code":""},{"path":"estimands.html","id":"estimands","chapter":"2 Path-specific casual mediation effect types","heading":"2 Path-specific casual mediation effect types","text":"Controlled direct effectsNatural direct indirect effectsInterventional direct indirect effects","code":""},{"path":"estimands.html","id":"controlled-direct-effects","chapter":"2 Path-specific casual mediation effect types","heading":"Controlled direct effects","text":"\\[\\begin{equation*}\n  \\psi_{\\text{CDE}} = \\E(Y_{1,m}) - \\E(Y_{0,m})\n\\end{equation*}\\]Set \\(M=m\\) uniformly everyone sampleIndependence assumptions:\n\\(\\indep Y_{,m} \\mid W\\)\n\\(M \\indep Y_{,m} \\mid W, \\)\n\\(\\indep Y_{,m} \\mid W\\)\\(M \\indep Y_{,m} \\mid W, \\)Positivity assumptions:\n\\(\\P(M = m \\mid =, W) > 0 \\text{  } .e.\\)\n\\(\\P(=\\mid W) > 0 \\text{  } .e.\\)\n\\(\\P(M = m \\mid =, W) > 0 \\text{  } .e.\\)\\(\\P(=\\mid W) > 0 \\text{  } .e.\\)","code":""},{"path":"estimands.html","id":"is-this-the-estimand-i-want","chapter":"2 Path-specific casual mediation effect types","heading":"2.0.1 Is this the estimand I want?","text":"Makes sense can intervene directly \\(M\\)\ncan think policy set everyone single constant\nlevel \\(m \\\\mathcal{M}\\).\nJ. Pearl calls prescriptive.\nCan think example?\nAir pollution, rescue inhaler dosage, hospital visits\ncan think policy set everyone single constant\nlevel \\(m \\\\mathcal{M}\\).J. Pearl calls prescriptive.Can think example?Air pollution, rescue inhaler dosage, hospital visitsWhat research question doesn’t involve intervening directly \nmediator?","code":""},{"path":"estimands.html","id":"natural-direct-and-indirect-effects","chapter":"2 Path-specific casual mediation effect types","heading":"Natural direct and indirect effects","text":"Natural direct effect (NDE):\n\\[\\begin{equation*}\n  \\psi_{\\text{NDE}} = \\E(Y_{1,M_0}) - \\E(Y_{0,M_0})\n\\end{equation*}\\]Natural indirect effect (NIE):\n\\[\\begin{equation*}\n  \\psi_{\\text{NIE}} = \\E(Y_{1,M_1}) - \\E(Y_{1,M_0})\n\\end{equation*}\\]NDE can also written : \\(\\E_W \\sum_m \\{\\E(Y_{1,m} \\mid W) - \\E(Y_{0,m} \\mid W)\\} \\P(M_{0}=m \\mid W)\\)Weighted average controlled direct effects level \\(m\\).interaction \\(\\) \\(M\\) \\(Y\\), CDE = NDE.","code":""},{"path":"estimands.html","id":"identification-assumptions","chapter":"2 Path-specific casual mediation effect types","heading":"2.0.2 Identification assumptions:","text":"\\(\\indep Y_{,m} \\mid W\\)\\(M \\indep Y_{,m} \\mid W, \\)\\(\\indep M_a \\mid W\\)\\(M_{^{\\star}} \\indep Y_{,m} \\mid W\\)positivity assumptionsWhat \\(M_0 \\indep Y_{1,m} \\mid W\\) mean?Conditional \\(W\\), knowledge \\(M\\) absence treatment \\(\\)\nprovides information effect \\(\\) \\(Y\\).Can think data-generating mechanism violate \nassumption?Whenever believe treatment assignment works adherence (.e.,\nalmost always), violating assumption.","code":""},{"path":"estimands.html","id":"is-this-the-estimand-i-want-1","chapter":"2 Path-specific casual mediation effect types","heading":"2.0.3 Is this the estimand I want?","text":"Makes sense intervene \\(\\) directly \\(M\\).Want understand natural mechanism underlying association/ total\neffect. J. Pearl calls descriptive.NDE + NIE = total effect (ATE).Okay assumptions.\ndata structure involves post-treatment confounder \nmediator-outcome relationship (e.g., adherence)?","code":""},{"path":"estimands.html","id":"interventional-direct-indirect-effects","chapter":"2 Path-specific casual mediation effect types","heading":"Interventional direct/ indirect effects","text":"Fully conditional pastConditional SDE: \\(\\E(Y_{, g_{M \\mid Z, ^{\\star}, W}}) - \\E(Y_{^{\\star}, g_{M \\mid Z, ^{\\star}, W}})\\)Conditional SIE: \\(\\E(Y_{, g_{M \\mid Z, , W}}) - \\E(Y_{, g_{M \\mid Z, ^{\\star}, W}})\\)Marginal SDE: \\(\\E(Y_{, g_{M \\mid ^{\\star}, W}}) - \\E(Y_{^{\\star}, g_{M \\mid ^{\\star}, W}})\\)Marginal SIE: \\(\\E(Y_{, g_{M \\mid , W}}) - \\E(Y_{, g_{M \\mid ^{\\star}, W}})\\)Note \\(g_{M \\mid Z, ^{\\star}, W}\\), \\(g_{M \\mid ^{\\star}, W}\\) represents\nstochastic intervention mediator, value \\(m\\) drawn \nprobability \\(\\P(M = m \\mid Z, = ^{\\star}, W = w)\\),\n\\(\\P(M = m \\mid = ^{\\star}, W = w)\\), respectivelyCan think example want conditional versions?\nMarginal versions?","code":""},{"path":"estimands.html","id":"identification-assumptions-1","chapter":"2 Path-specific casual mediation effect types","heading":"2.0.4 Identification assumptions:","text":"\\(\\indep Y_{,m} \\mid W\\)\\(M \\indep Y_{,m} \\mid W, \\)\\(\\indep M_a \\mid W\\)positivity assumptions.estimand want?Makes sense intervene \\(\\) directly \\(M\\).Goal understand natural mechanism underlying association total\neffect.Okay assumptions!","code":""},{"path":"estimands.html","id":"estimand-summary","chapter":"2 Path-specific casual mediation effect types","heading":"Estimand Summary","text":"","code":""},{"path":"estimandirl.html","id":"estimandirl","chapter":"3 How to choose an estimand: Real world example","heading":"3 How to choose an estimand: Real world example","text":"","code":""},{"path":"estimandirl.html","id":"comparative-effectivness-of-two-medications-for-opioid-use-disorder-oud","chapter":"3 How to choose an estimand: Real world example","heading":"3.1 Comparative effectivness of two medications for opioid use disorder (OUD)","text":"Motivation: Opposite overall treatment effects homeless versus\nnonhomeless participants.","code":""},{"path":"estimandirl.html","id":"getting-specific-about-the-question","chapter":"3 How to choose an estimand: Real world example","heading":"3.1.1 Getting specific about the question","text":"extent indirect effect mediators adherence, pain,\ndepressive symptoms explain differences treatment effects OUD\nrelapse homeless nonhomeless individuals?estimand want?Can set \\(M=m\\) (.e., value) everyone?interested estimating indirect effects?\\(\\rightarrow\\) , controlled direct effect.intermediate confounder?Yes, ’s important.\\(\\rightarrow\\) , natural ()direct effects., ’re left interventional direct indirect effects.want estimate path treatment initiation (\\(Z\\))?Yes, , conditional versions effects.Estimands:\nDirect effect: \\(\\E(Y_{1,g_0} - Y_{0,g_0})\\)\nIndirect effect: \\(\\E(Y_{1,g_1} - Y_{1,g_0})\\)\nDirect effect: \\(\\E(Y_{1,g_0} - Y_{0,g_0})\\)Indirect effect: \\(\\E(Y_{1,g_1} - Y_{1,g_0})\\)Need incorporate multiple continuous mediators","code":""},{"path":"interventional.html","id":"interventional","chapter":"4 The Interventional Direct and Indirect Effects","heading":"4 The Interventional Direct and Indirect Effects","text":"[FILL ]","code":""},{"path":"estimation-of-natural-indirect-effects-interventional-indirect-effects.html","id":"estimation-of-natural-indirect-effects-interventional-indirect-effects","chapter":"5 Estimation of natural (in)direct effects, interventional (in)direct effects","heading":"5 Estimation of natural (in)direct effects, interventional (in)direct effects","text":"","code":""},{"path":"estimation-of-natural-indirect-effects-interventional-indirect-effects.html","id":"interventional-direct-and-indirect-effects","chapter":"5 Estimation of natural (in)direct effects, interventional (in)direct effects","heading":"5.1 Interventional direct and indirect effects","text":"Recall:define interventional direct effect :\n\\[\\begin{equation*}\n  \\psi_{\\text{PIDE}} = \\E(Y_{^\\prime,g_{M \\mid ^\\star,W}}) -\n    \\E(Y_{\\star,g_{M \\mid ^\\star,W}}),\n\\end{equation*}\\]\ninterventional indirect effect :\n\\[\\begin{equation*}\n  \\psi_{\\text{PIIE}} = \\E(Y_{^\\prime,g_{M \\mid ^\\prime,W}}) -\n    \\E(Y_{^\\prime,g_{M \\mid ^\\star,W}}).\n\\end{equation*}\\]","code":""},{"path":"estimation-of-natural-indirect-effects-interventional-indirect-effects.html","id":"simple-case-for-intuition","chapter":"5 Estimation of natural (in)direct effects, interventional (in)direct effects","heading":"5.2 Simple case for intuition","text":"Consider simple data structure \\(O=(W, , Z, M, Y)\\). SCM represented \nDAG following causal models:\n\\[\\begin{align*}\n  W &= f(U_W)\\\\\n  &= f(U_A)\\\\\n  Z &= f(, W, U_Z)\\\\\n  M &= f(Z, , W, U_M)\\\\\n  Y &= f(M, Z, , W, U_Y),\n\\end{align*}\\]\n(\\(U_W, U_A, U_Z, U_M, U_Y\\)) exogenous random errors. assume \\(\\) \nsingle binary treatment, \\(Z\\) single binary intermediate confounder, \\(M\\)\nsingle binary mediator. restrictions distribution \n\\(W\\) \\(Y\\).\\(g_{M \\mid ^\\prime,W}\\) represents stochastic draw counterfactual,\nconditional distribution \\(M\\), described \n(???):\n\\[\\begin{equation*}\n  g_{M \\mid ,W}(m, ^{\\star}, W) \\equiv g_{M \\mid ^{\\star}, W}(W) =\n    \\sum_{z=0}^1 \\P(M=1 \\mid Z=z,W) \\P(Z=z \\mid =^{\\star}, W).\n\\end{equation*}\\]\nfollows, going assume \\(g_{M \\mid ,W}(m, ^{\\star}, W)\\)\nknown, estimated observed data, call\n\\(\\hat{g}_{M \\mid ^{\\star}, W}\\). going slightly alter usual\nidentification assumptions longer need assume exchangeability\n\\(\\) counterfactual \\(M\\) values. means remaining assumptions\ncontrolled direct effects.","code":""},{"path":"estimation-of-natural-indirect-effects-interventional-indirect-effects.html","id":"estimation-using-g-computation","chapter":"5 Estimation of natural (in)direct effects, interventional (in)direct effects","heading":"5.2.1 Estimation using G-Computation","text":"estimand \\(E(Y_{^\\prime, \\hat{g}_{M \\mid ^\\star,W}})\\) can identified\nvia sequential regression, provides framework \nG-computation-based estimator. procedure followsFit regression \\(Y\\) \\(M,Z,W\\). Predict outcome values \n\\(M=m\\). ’ll call result \\(\\bar{Q}_Y(M,Z,W)\\).Integrate \\(M\\) stochastic intervention\n\\(\\hat{g}_{M \\mid ^{\\star}, W}\\). can evaluating\n\\(\\E(Y \\mid M=m,Z=z,W)\\) \\(m\\) multiplying probability\n\\(M=m\\) \\(\\hat{g}_{M \\mid ^{\\star}, W}\\), summing \\(m\\).\n’ll call results \\(\\bar{Q}^{g}_M(Z,W)\\).Integrate \\(Z\\) set \\(=^\\prime\\). , can evaluating\npredicted values Step 2, setting \\(=^\\prime\\), \\(z\\),\nmultiplying prediction probability \\(Z=z\\) \\(=^\\prime\\).\n’ll call result \\(\\bar{Q}^{^\\prime}_Z(W)\\).Taking sample mean (marginalizing \\(W\\)) gives parameter\nestimate.","code":""},{"path":"estimation-of-natural-indirect-effects-interventional-indirect-effects.html","id":"estimate-with-doubly-robust-methods-based-on-the-eif","chapter":"5 Estimation of natural (in)direct effects, interventional (in)direct effects","heading":"5.2.2 Estimate with doubly robust methods based on the EIF","text":"EIF parameter \\(\\Psi(P)(^{\\prime}, \\hat{g}_{M \\mid ^{\\star},W})\\),\n, , \\(\\hat{g}_{M \\mid ^{\\star}, W}\\) assumed known, given :\n\\[\\begin{align*}\n  D^{\\star}(^{\\prime}, \\hat{g}_{M \\mid ^{\\star}, W}) &= \\sum_{k=0}^2\n      D_k^{\\star}(^{\\prime}, \\hat{g}_{M \\mid ^{\\star}, W}), \\text{ }\\\\\n  D^{\\star}_0(^{\\prime}, \\hat{g}_{M \\mid ^{\\star}, W}) &=\n      \\bar{Q}^{^{\\prime}}_{Z(W)} -\n      \\Psi(P)(^{\\prime}, \\hat{g}_{M \\mid ^{\\star}, W})\\\\\n  D^{\\star}_1(^{\\prime}, \\hat{g}_{M \\mid ^{\\star}, W}) &=\n      \\frac{(=^{\\prime})}{\\P(=^{\\prime} \\mid W)}(\\bar{Q}^{\\hat{g}}_M(Z,W)\n      - \\bar{Q}^{^{\\prime}}_{Z(W)})\\\\\n  D^{\\star}_2(^{\\prime}, \\hat{g}_{M \\mid ^{\\star}, W}) &=\n      \\frac{(=^{\\prime})\\{(M=1) \\hat{g}_{M \\mid ^{\\star}, W} +\n      (M=0)(1-\\hat{g}_{M \\mid ^{\\star}, W}) \\}}{\\P(=^{\\prime}}\n      &\\times (Y-\\bar{Q}_{Y(M,Z,W)}).\n\\end{align*}\\]","code":""},{"path":"estimation-of-natural-indirect-effects-interventional-indirect-effects.html","id":"estimate-using-tmle","chapter":"5 Estimation of natural (in)direct effects, interventional (in)direct effects","heading":"5.2.3 Estimate using TMLE","text":"estimate \\(g_{Z \\mid ^{\\star}, W}(W) = \\P(Z=1 \\mid =^{\\star}, W)\\) \nlogistic regression \\(Z\\) \\(, W\\) setting \\(=^{\\star}\\).estimate \\(g_{M \\mid z,W}(W) = \\P(M=1 \\mid Z=z, W)\\) logistic\nregression \\(M\\) \\(Z, W\\), setting \\(z=\\{0,1\\}\\).use quantities calculate \\(\\hat{g}_{M \\mid ^{\\star}, W} = \\hat{g}_{M \\mid z=1,W}\\hat{g}_{Z \\mid ^{\\star}, W} + \\hat{g}_{M \\mid z=0,W}(1-\\hat{g}_{Z|^{\\star}, W})\\).obtain estimate \\(\\bar{Q}_{Y}(M,Z,W)\\), predict values \\(Y\\) \nregression \\(Y\\) \\(M,Z,W\\), setting \\(m=1\\) \\(m=0\\), giving\n\\(\\hat{Y}(m=1, z, w)\\) \\(\\hat{Y}(m=0, z, w)\\).Estimate weights used initial targeting step:\n\\[\\begin{equation*}\n   h_1() = \\frac{(=)\\{(M=1)\\hat{g}_{M \\mid ^{\\star}, W} +\n     (M=0)(1-\\hat{g}_{M \\mid ^{\\star}, W}) \\}}{\\P(=)\\{(M=1)\n     g_{M \\mid Z,W} + (M=0)(1-g_{M \\mid Z,W}) \\}}\n\\end{equation*}\\]Estimate \\(\\hat{\\epsilon}\\) setting \\(\\epsilon\\) intercept \nweighted logistic regression model \\(Y\\) \n\\(\\text{logit}(\\hat{\\bar{Q}}_{Y}(M,Z,W))\\) offset weights\n\\(\\hat{h}_{1}()\\). (Note just one possible TMLE.)Estimate \\(\\hat{\\epsilon}\\) setting \\(\\epsilon\\) intercept \nweighted logistic regression model \\(Y\\) \n\\(\\text{logit}(\\hat{\\bar{Q}}_{Y}(M,Z,W))\\) offset weights\n\\(\\hat{h}_{1}()\\). (Note just one possible TMLE.)estimate \\(\\bar{Q}_{Y}(M,Z,W)\\) updated \n\\(\\hat{\\bar{Q}}^{\\star}_{Y}(M,Z,W) = \\hat{\\bar{Q}}_{Y}(\\epsilon_n)(M,Z,W)\\).estimate \\(\\bar{Q}_{Y}(M,Z,W)\\) updated \n\\(\\hat{\\bar{Q}}^{\\star}_{Y}(M,Z,W) = \\hat{\\bar{Q}}_{Y}(\\epsilon_n)(M,Z,W)\\).next integrate \\(M\\) \\(\\bar{Q}^{\\star}_{Y}(M,Z,W)\\). First, \nestimate \\(\\bar{Q}^{\\star}_{Y,n}(M,Z,W)\\) setting \\(m=1\\) \\(m=0\\), giving\n\\(\\bar{Q}^{\\star}_Y(m=1, z, w)\\) \\(\\bar{Q}^{\\star}_Y(m=0, z, w)\\). ,\nmultiply predicted values probabilities \n\\(\\hat{g}_{M \\mid ^{\\star},W}(W)\\) (\\(\\\\{, ^{\\star}\\}\\)), add\ntogether (.e., \\(\\bar{Q}^{\\hat{g}}_{M,n}(Z,W) = \\hat{Q}^{\\star}_Y(m=1, z, w) \\hat{g}_{M|^{\\star},W} + \\hat{Q}^{\\star}_Y(m=0, z, w)(1-\\hat{g}_{M|^{\\star},W})\\)).now fit regression \\(\\bar{Q}^{\\hat{g},\\star}_{M,n}(Z,W)\\) \\(W\\)\namong \\(=^\\prime\\). call predicted values \nregression \\(\\hat{\\bar{Q}}^{^\\prime}_{Z}(W)\\).(Note \\(\\) randomly assigned, need complete \nsecond targeting step.)empirical mean predicted values TML estimate \n\\(\\Psi(P)(^\\prime, \\hat{g}_{M \\mid ^{\\star}, W})\\).Repeat steps interventions. example, \nbinary \\(\\), execute steps total three times \nestimate:\n\\(\\Psi(P)(1,\\hat{g}_{M \\mid 1, W})\\),\n\\(\\Psi(P)(1,\\hat{g}_{M \\mid 0, W})\\), \n\\(\\Psi(P)(0,\\hat{g}_{M \\mid 0, W})\\).\n\\(\\Psi(P)(1,\\hat{g}_{M \\mid 1, W})\\),\\(\\Psi(P)(1,\\hat{g}_{M \\mid 0, W})\\), \\(\\Psi(P)(0,\\hat{g}_{M \\mid 0, W})\\).PIDE can obtained substituting estimates parameters\n\\(\\Psi(P)(,\\hat{g}_{M \\mid ^{\\star}, W}) - \\Psi(P)(^{\\star},\\hat{g}_{M \\mid ^{\\star}, W})\\) PIIE\ncan obtained substituting estimates parameters\n\\(\\Psi(P)(,\\hat{g}_{M \\mid ,W}) - \\Psi(P)(, \\hat{g}_{M \\mid ^{\\star}, W})\\).variance can estimated sample variance EIF (defined\n, substituting targeted fits) divided \\(n\\).","code":"\nzmodel <- \"z ~ a + w1 \"\nmmodel <- \"m ~ z + w1\"\nymodel <- \"y ~ m + z*w1\"\n\n# make gm and get counterfactual predictions\nzfit <- glm(formula = zmodel, family = \"binomial\", data = obsdat)\nmfit <- glm(formula = mmodel, family = \"binomial\", data = obsdat)\n\nza0 <- predict(zfit, newdata = data.frame(w1 = obsdat$w1, a = 0),\n               type = \"response\")\nza1 <- predict(zfit, newdata = data.frame(w1 = obsdat$w1, a = 1),\n               type = \"response\")\n\nmz1 <- predict(mfit, newdata = data.frame(w1 = obsdat$w1, z = 1),\n               type = \"response\")\nmz0 < -predict(mfit, newdata = data.frame(w1 = obsdat$w1, z = 0),\n               type = \"response\")\n\ngm0 <- (mz1 * za0) + (mz0 * (1 - za0))\ngma1 <- (mz1 * za1) + (mz0 * (1 - za1))\ntmpdat$qyinit <- cbind(\n  predict(glm(formula = ymodel, family = \"binomial\",\n              data = data.frame(cbind(datw, z = z, m = m, y = y))),\n          newdata = data.frame(cbind(datw, z = z, m = m)), type = \"response\"),\n  predict(glm(formula = ymodel, family = \"binomial\",\n              data = data.frame(cbind(datw, z = z, m = m, y = y))),\n          newdata = data.frame(cbind(datw, z = z, m = 0)), type = \"response\"),\n  predict(glm(formula = ymodel, family = \"binomial\",\n              data = data.frame(cbind(datw, z = z, m = m, y = y))),\n          newdata = data.frame(cbind(datw, z = z, m = 1)), type = \"response\")\n)\npsa1 <- I(a == 1) / mean(a)\npsa0 <- I(a == 0) / mean(1 - a)\nmz <- predict(glm(formula = mmodel, family = \"binomial\",\n                  data = data.frame(cbind(datw, z = z, m = m))),\n              newdata = data.frame(cbind(datw, z = z)), type = \"response\")\npsm <- (mz * m) + ((1 - mz) * (1 - m))\n\ntmpdat$ha1gma1 <- ((m * gma1 + (1 - m) * (1 - gma1)) / psm) * psa1 * svywt\ntmpdat$ha1gma0 <- ((m * gm + (1 - m) * (1 - gm)) / psm) * psa1 * svywt\ntmpdat$ha0gma0 <- ((m * gm + (1 - m) * (1 - gm)) / psm) * psa0 * svywt\n# for E(Y_{1,gmastar})\nepsilonma1g0 <- coef(glm(y ~ 1, weights = tmpdat$ha1gma0,\n                         offset = (qlogis(qyinit[, 1])),\n                         family = \"quasibinomial\", data = tmpdat))\ntmpdat$qyupm0a1g0 <- plogis(qlogis(tmpdat$qyinit[, 2]) + epsilonma1g0)\ntmpdat$qyupm1a1g0 <- plogis(qlogis(tmpdat$qyinit[, 3]) + epsilonma1g0)\n\n# for E(Y_{1,gma})\nepsilonma1g1 <- coef(glm(y ~ 1, weights = tmpdat$ha1gma1,\n                         offset = (qlogis(qyinit[, 1])),\n                         family = \"quasibinomial\", data = tmpdat))\ntmpdat$qyupm0a1g1 <- plogis(qlogis(tmpdat$qyinit[, 2]) + epsilonma1g1)\ntmpdat$qyupm1a1g1 <- plogis(qlogis(tmpdat$qyinit[, 3]) + epsilonma1g1)\n\n# for E(Y_{0,gmastar})\nepsilonma0g0 <- coef(glm(y ~ 1, weights = tmpdat$ha0gma0,\n                         offset = (qlogis(qyinit[, 1])),\n                         family = \"quasibinomial\", data = tmpdat))\ntmpdat$qyupm0a0g0 <- plogis(qlogis(tmpdat$qyinit[, 2]) + epsilonma0g0)\ntmpdat$qyupm1a0g0 <- plogis(qlogis(tmpdat$qyinit[, 3]) + epsilonma0g0)\ntmpdat$Qma1g0 <- tmpdat$qyupm0a1g0 * (1 - gm) + tmpdat$qyupm1a1g0 * gm\ntmpdat$Qma1g1 <- tmpdat$qyupm0a1g1 * (1 - gma1) + tmpdat$qyupm1a1g1 * gma1\ntmpdat$Qma0g0 <- tmpdat$qyupm0a0g0 * (1 - gm) + tmpdat$qyupm1a0g0 * gm\nQzfita1g0 <- glm(formula = paste(\"Qma1g0\", qmodel, sep = \"~\"),\n                 data = tmpdat[tmpdat$a == 1, ], family = \"quasibinomial\")\nQzfita1g1 <- glm(formula = paste(\"Qma1g1\", qmodel, sep = \"~\"),\n                 data = tmpdat[tmpdat$a == 1, ], family = \"quasibinomial\")\nQzfita0g0 <- glm(formula = paste(\"Qma0g0\", qmodel, sep = \"~\"),\n                 data = tmpdat[tmpdat$a == 0, ], family = \"quasibinomial\")\n\nQza1g0 <- predict(Qzfita1g0, type = \"response\", newdata = tmpdat)\nQza1g1 <- predict(Qzfita1g1, type = \"response\", newdata = tmpdat)\nQza0g0 <- predict(Qzfita0g0, type = \"response\", newdata = tmpdat)\ntmlea1m0 <- sum(Qzupa1g0 * svywt) / sum(svywt)\ntmlea1m1 <- sum(Qzupa1g1 * svywt) / sum(svywt)\ntmlea0m0 <- sum(Qzupa0g0 * svywt) / sum(svywt)\nnde <- tmlea1m0 - tmlea0m0\nnie <- tmlea1m1 - tmlea1m0\n# first get EIF\ntmpdat$qyupa1g0 <- plogis(qlogis(tmpdat$qyinit[, 1]) + epsilonma1g0)\ntmpdat$qyupa1g1 <- plogis(qlogis(tmpdat$qyinit[, 1]) + epsilonma1g1)\ntmpdat$qyupa0g0 <- plogis(qlogis(tmpdat$qyinit[, 1]) + epsilonma0g0)\n\neic1a1g0 <- tmpdat$ha1gma0 * (tmpdat$y - tmpdat$qyupa1g0)\neic2a1g0 <- psa1 * svywt * (tmpdat$Qma1g0 - Qzupa1g0)\neic3a1g0 <- Qzupa1g0 - tmlea1m0\neica1g0 <- eic1a1g0 + eic2a1g0 + eic3a1g0\n\neic1a1g1 <- tmpdat$ha1gma1 * (tmpdat$y - tmpdat$qyupa1g1)\neic2a1g1 <- psa1 * svywt * (tmpdat$Qma1g1 - Qzupa1g1)\neic3a1g1 <- Qzupa1g1 - tmlea1m1\neica1g1 <- eic1a1g1 + eic2a1g1 + eic3a1g1\n\neic1a0g0 <- tmpdat$ha0gma0 * (tmpdat$y - tmpdat$qyupa0g0)\neic2a0g0 <- psa0 * svywt * (tmpdat$Qma0g0 - Qzupa0g0)\neic3a0g0 <- Qzupa0g0 - tmlea0m0\neica0g0 <- eic1a0g0 + eic2a0g0 + eic3a0g0\n\n# estimands\nndeeic <- eica1g0 - eica0g0\nvareic <- var(ndeeic) / nrow(tmpdat)\n\nnieeic <- eica1g1 - eica1g0\nvarnieeic <- var(nieeic) / nrow(tmpdat)"},{"path":"estimation-of-natural-indirect-effects-interventional-indirect-effects.html","id":"the-general-case","chapter":"5 Estimation of natural (in)direct effects, interventional (in)direct effects","heading":"5.3 The general case","text":"Actually, want fixed parameter true, unknown\n\\(g_{M \\mid , W}\\) like \\(M\\) continuous/multi-dimensional.pain hand, Nima made easy--use package us\ncalled medoutcon! go \nnext.","code":""},{"path":"references.html","id":"references","chapter":"References","heading":"References","text":"","code":""}]
